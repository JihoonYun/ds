<h2>Naive Bayes Code</h2>
<br/>
<p>To perform a Naïve Bayes analysis, each variable is assigned to the training and test datasets partitioned in the previous step. Then, a Naïve Bayes model is created, and the test dataset is used to predict vehicle prices. Finally, the prediction model is evaluated by varying the input of each feature and comparing the performance of each model's predictions. At this point, the iterative program creates user-defined functions to make the code more concise.</p>

<div class="line"></div>
<br/>
<h5><b>Related source code and dataset URLs</b></h5>
<table class="table  table-sm" style="font-size: 12px;">
  <tbody>
    <tr>
      <th>ml_nb_code.R</th>
      <td>Source code file for the Naive Bayes</td>
      <td><a href="https://github.com/JihoonYun/ds/blob/main/src/ml_nb_code.R" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_nb_sampled_preprocessed_train_data.csv</th>
      <td>Test dataset in the Naive Bayes step</td>
      <td><a href="https://drive.google.com/file/d/1MqyLXK_BsEePcaCYRls7vpwvdLfl5TRZ/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_nb_sampled_preprocessed_test_data.csv</th>
      <td>Test dataset in the Naive Bayes step</td>
      <td><a href="https://drive.google.com/file/d/1ztx2HSCerXJBVgmhUpAgQDV6v_lz-dPM/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
  </tbody>
</table>

<a class="btn btn-secondary btn-sm" data-toggle="collapse" href="#collapseCode001" role="button" aria-expanded="false" aria-controls="collapseExample">
  View Code
</a> &nbsp;&nbsp;<h7>Click the <b>View Code</b> button to check the entire source code.</h7>
<div class="collapse" id="collapseCode001">
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto;font-size: 11px;"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Required&nbsp;libraries</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">library(dplyr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(png)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(grDevices)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(Metrics)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(reshape2)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(ggplot2)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(tidyr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(knitr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(kableExtra)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(e1071)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(caTools)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(caret)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Load&nbsp;CSV&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read.csv(<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_nb_sampled_preprocessed_train_data.csv"</span>,&nbsp;row.names&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">test_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read.csv(<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_nb_sampled_preprocessed_test_data.csv"</span>,&nbsp;row.names&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Convert&nbsp;all&nbsp;columns&nbsp;to&nbsp;factors</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_data[]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;lapply(train_data,&nbsp;<span style="color:#ff3399">as</span>.factor)</div><div style="padding:0 6px; white-space:pre; line-height:130%">test_data[]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;lapply(test_data,&nbsp;<span style="color:#ff3399">as</span>.factor)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Split&nbsp;the&nbsp;dataset&nbsp;into&nbsp;training&nbsp;and&nbsp;test&nbsp;sets&nbsp;(70%&nbsp;train,&nbsp;30%&nbsp;test)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;set.seed(123)&nbsp;&nbsp;#&nbsp;for&nbsp;reproducibility</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;split&nbsp;&lt;-&nbsp;sample.split(df$label,&nbsp;SplitRatio&nbsp;=&nbsp;0.7)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;train_data&nbsp;&lt;-&nbsp;df[split,&nbsp;]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;test_data&nbsp;&lt;-&nbsp;df[!split,&nbsp;]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;functions</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">calculate_metrics&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;function(conf_matrix,&nbsp;features)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;sum(diag(conf_matrix))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;sum(conf_matrix)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;diag(conf_matrix)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;colSums(conf_matrix)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;diag(conf_matrix)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;rowSums(conf_matrix)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;f1_score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">2</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>&nbsp;(precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;recall)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;result&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Features&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;features[<span style="color:#c10aff">3</span>],&nbsp;Class&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(<span style="color:#ffd500">"Low"</span>,&nbsp;<span style="color:#ffd500">"Moderate"</span>,&nbsp;<span style="color:#ffd500">"High"</span>),&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy,&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;precision,&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recall,&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;f1_score)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;rownames(result)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">return</span>(result)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">analyze_nb&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;function(features,&nbsp;result_df)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Build&nbsp;a&nbsp;Naive&nbsp;Bayes&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;naiveBayes(features,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_data)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Make&nbsp;predictions&nbsp;on&nbsp;the&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;test_data,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Calculate&nbsp;the&nbsp;confusion&nbsp;matrix</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;conf_matrix&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusionMatrix(predictions,&nbsp;test_data$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Calculate&nbsp;accuracy,&nbsp;precision,&nbsp;recall,&nbsp;specificity,&nbsp;and&nbsp;F1&nbsp;score&nbsp;for&nbsp;Gini&nbsp;method</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rbind(result_df,&nbsp;calculate_metrics(conf_matrix$table,&nbsp;<span style="color:#ff3399">as</span>.character(features)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;(list(result_df,&nbsp;conf_matrix,&nbsp;model,&nbsp;predictions))</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;result&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(formula&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;character(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;character(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">result&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;analyze_nb(label&nbsp;~.,&nbsp;result_df)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Prior&nbsp;Probabilities:"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(result[[<span style="color:#c10aff">3</span>]]$apriori)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"\nConditional&nbsp;Probabilities:"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(result[[<span style="color:#c10aff">3</span>]]$table)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">png(<span style="color:#ffd500">"apriori_nb.png"</span>,&nbsp;width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3600</span>,&nbsp;height&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">2800</span>,&nbsp;units&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"px"</span>,&nbsp;pointsize&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">12</span>,&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">600</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">ggplot(<span style="color:#ff3399">as</span>.data.frame(result[[<span style="color:#c10aff">3</span>]]$apriori),&nbsp;aes(x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;class_labels,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;prior_prob,&nbsp;fill&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;class_labels))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_bar(stat&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"identity"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;labs(title&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Prior&nbsp;Probabilities&nbsp;of&nbsp;Vehicle&nbsp;Price&nbsp;Classes"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Price&nbsp;Class"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Prior&nbsp;Probability"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;theme_minimal()</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Save&nbsp;the&nbsp;plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">dev.off()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">result[[<span style="color:#c10aff">2</span>]]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">conf_mat_table&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#ff3399">as</span>.data.frame(result[[<span style="color:#c10aff">2</span>]]$table)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Visualization</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">png(<span style="color:#ffd500">"confusionMatrix_nb.png"</span>,&nbsp;width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3600</span>,&nbsp;height&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">2800</span>,&nbsp;units&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"px"</span>,&nbsp;pointsize&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">12</span>,&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">600</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">ggplot(data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;conf_mat_table,&nbsp;aes(x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Reference,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Prediction,&nbsp;fill&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Freq,&nbsp;label&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Freq))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_tile()&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_text(color&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"white"</span>,&nbsp;size&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">8</span>,&nbsp;fontface&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"bold"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;scale_fill_gradient(low&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"lightblue"</span>,&nbsp;high&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"darkblue"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;labs(title&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Confusion&nbsp;Matrix&nbsp;Heatmap&nbsp;based"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Reference"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Prediction"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Frequency"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Save&nbsp;the&nbsp;plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">dev.off()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Generate&nbsp;Html&nbsp;Table&nbsp;code</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">kable(result[[<span style="color:#c10aff">1</span>]],&nbsp;<span style="color:#4be6fa">format</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"html"</span>,&nbsp;table.attr&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'&nbsp;class="table&nbsp;&nbsp;table-sm"&nbsp;style="font-size:&nbsp;12px;"'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Clear&nbsp;df</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;result_df[<span style="color:#c10aff">0</span>,&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;formulars</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">fml&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;list(</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;mileage,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;mileage&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;year,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;mileage&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;year&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;highway_fuel_economy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;mileage&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;year&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;highway_fuel_economy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;wheelbase,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;label&nbsp;~&nbsp;horsepower&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;torque_lbft&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;fuel_tank_volume&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;mileage&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;year&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;highway_fuel_economy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;wheelbase&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;owner_count</div><div style="padding:0 6px; white-space:pre; line-height:130%">)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">1</span>:length(fml))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(fml[[i]])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;analyze_nb(fml[[i]],&nbsp;result_df)[[<span style="color:#c10aff">1</span>]]</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df</div><div style="padding:0 6px; white-space:pre; line-height:130%">kable(result_df,&nbsp;<span style="color:#4be6fa">format</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"html"</span>,&nbsp;table.attr&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'&nbsp;class="table&nbsp;&nbsp;table-sm"&nbsp;style="font-size:&nbsp;12px;"'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
</div>

