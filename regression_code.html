<h2>Regression Code</h2>
<br/>
<p>LinearRegression from the Python sklearn package is utilized to perform multiple linear regression. This creates a model and evaluates its performance. Then, linear equations are derived through Coefficients and Intercept.</p>


<br/>

<div class="line"></div>
<br/>
<h5><b>Related source code and dataset URLs</b></h5>
<table class="table  table-sm" style="font-size: 12px;">
  <tbody>
    <tr>
      <th>ml_svm_code.py</th>
      <td>Source code file for Regression</td>
      <td><a href="https://github.com/JihoonYun/ds/blob/main/src/ml_rg_code.py" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver.csv</th>
      <td>Dataset at DataPrep/EDA stage</td>
      <td><a href="https://drive.google.com/file/d/1zcaW9zeALdYRkoOBwqsVKsqmi3b63L6o/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_rg_sampled_preprocessed.csv</th>
      <td>Dataset sampled in Regression - data step</td>
      <td><a href="https://github.com/JihoonYun/ds/blob/main/src/used_cars_data_cleaned_final_ver_rg_sampled_preprocessed.csv" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
  </tbody>
</table>

<a class="btn btn-secondary btn-sm" data-toggle="collapse" href="#collapseCode001" role="button" aria-expanded="false" aria-controls="collapseExample">
  View Code
</a> &nbsp;&nbsp;<h7>Click the <b>View Code</b> button to check the entire source code.</h7>
<div class="collapse" id="collapseCode001">
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto;font-size: 11px;"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;pandas&nbsp;<span style="color:#ff3399">as</span>&nbsp;pd</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;matplotlib.pyplot&nbsp;<span style="color:#ff3399">as</span>&nbsp;plt</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;seaborn&nbsp;<span style="color:#ff3399">as</span>&nbsp;sns</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;sklearn.model_selection&nbsp;<span style="color:#ff3399">import</span>&nbsp;train_test_split</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;sklearn.linear_model&nbsp;<span style="color:#ff3399">import</span>&nbsp;LinearRegression</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;sklearn.metrics&nbsp;<span style="color:#ff3399">import</span>&nbsp;mean_squared_error,&nbsp;mean_absolute_error,&nbsp;r2_score</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;scipy.stats&nbsp;<span style="color:#ff3399">import</span>&nbsp;shapiro,&nbsp;probplot</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Load&nbsp;CSV</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;pd.read_csv(<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_rg_sampled_preprocessed.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Split&nbsp;the&nbsp;dataset&nbsp;into&nbsp;features&nbsp;(X)&nbsp;and&nbsp;target&nbsp;variable&nbsp;(y)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">X&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df.drop(<span style="color:#ffd500">'price'</span>,&nbsp;axis<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>)&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Features&nbsp;(independent&nbsp;variables)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df[<span style="color:#ffd500">'price'</span>]&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Target&nbsp;variable&nbsp;(dependent&nbsp;variable)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Split&nbsp;the&nbsp;data&nbsp;into&nbsp;training&nbsp;and&nbsp;testing&nbsp;sets&nbsp;(80%&nbsp;training,&nbsp;20%&nbsp;testing)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">X_train,&nbsp;X_test,&nbsp;y_train,&nbsp;y_test&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_test_split(X,&nbsp;y,&nbsp;test_size<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">2</span>,&nbsp;random_state<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">42</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Fit&nbsp;a&nbsp;multiple&nbsp;linear&nbsp;regression&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;LinearRegression()</div><div style="padding:0 6px; white-space:pre; line-height:130%">model.fit(X_train,&nbsp;y_train)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Make&nbsp;predictions&nbsp;on&nbsp;the&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">y_pred&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;model.predict(X_test)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Evaluate&nbsp;the&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">mse&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;mean_squared_error(y_test,&nbsp;y_pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"Mean&nbsp;Squared&nbsp;Error:&nbsp;{mse}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Evaluate&nbsp;the&nbsp;model&nbsp;with&nbsp;Mean&nbsp;Absolute&nbsp;Error&nbsp;(MAE)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">mae&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;mean_absolute_error(y_test,&nbsp;y_pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"Mean&nbsp;Absolute&nbsp;Error:&nbsp;{mae}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Evaluate&nbsp;the&nbsp;model&nbsp;with&nbsp;R-squared</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">r_squared&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;r2_score(y_test,&nbsp;y_pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"R-squared:&nbsp;{r_squared}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Check&nbsp;the&nbsp;assumptions&nbsp;of&nbsp;linear&nbsp;regression</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Residuals&nbsp;normality&nbsp;check&nbsp;using&nbsp;Shapiro-Wilk&nbsp;test</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">residuals&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;y_test&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;y_pred</div><div style="padding:0 6px; white-space:pre; line-height:130%">shapiro_test_stat,&nbsp;shapiro_p_value&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;shapiro(residuals)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"Shapiro-Wilk&nbsp;Test&nbsp;Statistic:&nbsp;{shapiro_test_stat}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"p-value:&nbsp;{shapiro_p_value}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Residuals&nbsp;vs&nbsp;Fitted&nbsp;Values&nbsp;Plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">sns.set(style<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">"whitegrid"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">sns.residplot(x<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>y_pred,&nbsp;y<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>residuals,&nbsp;lowess<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">True</span>,&nbsp;line_kws<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>{<span style="color:#ffd500">'color'</span>:&nbsp;<span style="color:#ffd500">'red'</span>},&nbsp;scatter_kws<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>{<span style="color:#ffd500">'alpha'</span>:&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>})</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.xlabel(<span style="color:#ffd500">'Fitted&nbsp;Values'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.ylabel(<span style="color:#ffd500">'Residuals'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.title(<span style="color:#ffd500">'Residuals&nbsp;vs&nbsp;Fitted&nbsp;Values&nbsp;Plot'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.show()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Numerical&nbsp;Analysis</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Mean&nbsp;of&nbsp;Residuals</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">mean_residual&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;residuals.mean()</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"Mean&nbsp;of&nbsp;Residuals:&nbsp;{mean_residual}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Standard&nbsp;Deviation&nbsp;of&nbsp;Residuals</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">std_residual&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;residuals.std()</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"Standard&nbsp;Deviation&nbsp;of&nbsp;Residuals:&nbsp;{std_residual}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Q-Q&nbsp;Plot&nbsp;(Quantile-Quantile&nbsp;Plot)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">probplot(residuals,&nbsp;dist<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">"norm"</span>,&nbsp;plot<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>plt)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.title(<span style="color:#ffd500">"Q-Q&nbsp;Plot"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.show()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Visualize&nbsp;the&nbsp;linear&nbsp;regression&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.scatter(y_test,&nbsp;y_pred,&nbsp;alpha<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>,&nbsp;label<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'Actual&nbsp;vs&nbsp;Predicted'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.plot([min(y_test),&nbsp;max(y_test)],&nbsp;[min(y_test),&nbsp;max(y_test)],&nbsp;color<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'red'</span>,&nbsp;linestyle<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'--'</span>,&nbsp;linewidth<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">2</span>,&nbsp;label<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'Regression&nbsp;Line'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.xlabel(<span style="color:#ffd500">'Actual&nbsp;Prices'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.ylabel(<span style="color:#ffd500">'Predicted&nbsp;Prices'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.title(<span style="color:#ffd500">'Actual&nbsp;Prices&nbsp;vs&nbsp;Predicted&nbsp;Prices&nbsp;with&nbsp;Regression&nbsp;Line'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.legend()</div><div style="padding:0 6px; white-space:pre; line-height:130%">plt.show()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Print&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;the&nbsp;linear&nbsp;regression&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">coefficients&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;model.coef_</div><div style="padding:0 6px; white-space:pre; line-height:130%">intercept&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;model.intercept_</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Intercept:"</span>,&nbsp;intercept)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Coefficients&nbsp;for&nbsp;each&nbsp;independent&nbsp;variable:"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;feature,&nbsp;coef&nbsp;<span style="color:#ff3399">in</span>&nbsp;zip(X.columns,&nbsp;coefficients):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"{feature}:&nbsp;{coef}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>    
</div>