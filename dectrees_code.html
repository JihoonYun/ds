<h2>Decision Trees Code</h2>
<br/>
<p>The 'rpart' package is applied to perform the decision tree in this step. The 'rpart' package implements the CART (Classification and Regression Trees) algorithm used in R. This package can be used to generate decision trees and perform classification and regression analysis. This step utilizes two impurity measures, Gini and Information Gain. It analyzes how each measure affects the performance of the decision tree and finds the best-performing decision tree. Decision trees tend to overfit the data by default. To address this, pruning is performed, and its impact is analyzed. In addition, the 'minsplit' parameter, which specifies the minimum number of observations needed to split a node, and the 'maxdepth' parameter, which limits the maximum depth of the tree, are applied to explore and analyze the tree that performs optimally.</p>
<br/>

<div class="line"></div>
<br/>
<h5><b>Related source code and dataset URLs</b></h5>
<table class="table  table-sm" style="font-size: 12px;">
  <tbody>
    <tr>
      <th>ml_dt_data.R</th>
      <td>Data preprocessing source code file for the decision tree</td>
      <td><a href="https://github.com/JihoonYun/ds/blob/main/src/ml_dt_data.R" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver.csv</th>
      <td>Dataset at DataPrep/EDA stage</td>
      <td><a href="https://drive.google.com/file/d/1zcaW9zeALdYRkoOBwqsVKsqmi3b63L6o/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_sampled.csv</th>
      <td>Dataset sampled in the decision tree step</td>
      <td><a href="https://drive.google.com/file/d/1QTSzRdB228BOfzoC837v5bqvetd_FG-Q/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_dt_sampled_preprocessed.csv</th>
      <td>Dataset preprocessed in the decision tree step</td>
      <td><a href="https://drive.google.com/file/d/1-HOZgacxoOcj60KJ3WpTXNtvKfnGjBNi/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_dt_sampled_preprocessed_train.csv</th>
      <td>Train dataset in the decision tree step</td>
      <td><a href="https://drive.google.com/file/d/17XKPBfjWC7rn077BxVg1VuaAGYnQKNmi/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
    <tr>
      <th>used_cars_data_cleaned_final_ver_dt_sampled_preprocessed_test.csv</th>
      <td>Test dataset in the decision tree step</td>
      <td><a href="https://drive.google.com/file/d/1FTyYpJacV_qqF19STEg1UF1W1bYdElIX/view?usp=sharing" target="_blank"><button type="button" class="btn btn-outline-warning btn-sm">Link</button></a></td>
    </tr>
  </tbody>
</table>

<a class="btn btn-secondary btn-sm" data-toggle="collapse" href="#collapseCode001" role="button" aria-expanded="false" aria-controls="collapseExample">
  View Code
</a> &nbsp;&nbsp;<h7>Click the <b>View Code</b> button to check the entire source code.</h7>
<div class="collapse" id="collapseCode001">
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto;font-size: 11px;"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Required&nbsp;libraries</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">library(dplyr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(rpart)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(rpart.plot)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(RColorBrewer)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(rattle)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(caret)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(png)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(grDevices)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(Metrics)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(reshape2)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(ggplot2)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(tidyr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(knitr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(kableExtra)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Load&nbsp;CSV&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read.csv(<span style="color:#ffd500">"used_cars_data_cleaned_final_ver.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">str</span>(df)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Set&nbsp;seed&nbsp;for&nbsp;reproducibility</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">set.seed(<span style="color:#c10aff">2010</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Number&nbsp;of&nbsp;rows&nbsp;to&nbsp;sample&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">num_rows_to_sample&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">100000</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Randomly&nbsp;sample&nbsp;100&nbsp;rows&nbsp;from&nbsp;the&nbsp;scaled_data&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_sampled&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df[sample(nrow(df),&nbsp;num_rows_to_sample,&nbsp;replace&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE),&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;store&nbsp;CSV&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">write.csv(df_sampled,&nbsp;<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_dt_sampled.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_sampled&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read.csv(<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_dt_sampled.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Extract&nbsp;the&nbsp;desired&nbsp;columns&nbsp;from&nbsp;scaled_org_data</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Exclude&nbsp;fields&nbsp;inappropriate&nbsp;for&nbsp;analysis</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;df_dt&nbsp;&lt;-&nbsp;df_sampled[,&nbsp;c('transmission',&nbsp;'fuel_type',&nbsp;'wheel_system',&nbsp;'body_type',&nbsp;"city_fuel_economy",&nbsp;"highway_fuel_economy",&nbsp;"engine_displacement",&nbsp;&nbsp;"fuel_tank_volume",&nbsp;"engine_cylinders",&nbsp;"horsepower",&nbsp;"torque_lbft",&nbsp;"mileage",&nbsp;"year",&nbsp;"width",&nbsp;"length",&nbsp;"owner_count",&nbsp;"has_accidents",&nbsp;"fleet",&nbsp;"body_type",&nbsp;"price")]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;subset(df_sampled,&nbsp;select&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>c(sp_name,&nbsp;sp_id,&nbsp;latitude,&nbsp;listing_color,&nbsp;interior_color,&nbsp;longitude,&nbsp;is_luxury,&nbsp;trim_name,&nbsp;model_name,&nbsp;major_options,&nbsp;main_picture_url,&nbsp;listing_id,&nbsp;description,&nbsp;vin,&nbsp;dealer_zip,&nbsp;city,&nbsp;exterior_color,franchise_make,&nbsp;listed_date,&nbsp;make_name,state,&nbsp;X.<span style="color:#c10aff">3</span>,&nbsp;X.<span style="color:#c10aff">2</span>,&nbsp;X.<span style="color:#c10aff">1</span>,X))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Convert&nbsp;categorical&nbsp;variables&nbsp;to&nbsp;numeric&nbsp;types&nbsp;through&nbsp;One-Hot&nbsp;Encoding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Perform&nbsp;one-hot&nbsp;encoding&nbsp;for&nbsp;the&nbsp;'transmission'&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cbind(df_dt,&nbsp;model.matrix(~&nbsp;transmission&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Remove&nbsp;the&nbsp;original&nbsp;'transmission'&nbsp;column&nbsp;after&nbsp;encoding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded[,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">!</span>names(df_dt)&nbsp;%<span style="color:#ff3399">in</span>%&nbsp;<span style="color:#ffd500">'transmission'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Perform&nbsp;one-hot&nbsp;encoding&nbsp;for&nbsp;the&nbsp;'fuel_type'&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cbind(df_dt_encoded,&nbsp;model.matrix(~&nbsp;fuel_type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_encoded))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Remove&nbsp;the&nbsp;original&nbsp;'fuel_type'&nbsp;column&nbsp;after&nbsp;encoding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded[,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">!</span>names(df_dt_encoded)&nbsp;%<span style="color:#ff3399">in</span>%&nbsp;<span style="color:#ffd500">'fuel_type'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Perform&nbsp;one-hot&nbsp;encoding&nbsp;for&nbsp;the&nbsp;'wheel_system'&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cbind(df_dt_encoded,&nbsp;model.matrix(~&nbsp;wheel_system&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_encoded))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Remove&nbsp;the&nbsp;original&nbsp;'wheel_system'&nbsp;column&nbsp;after&nbsp;encoding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded[,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">!</span>names(df_dt_encoded)&nbsp;%<span style="color:#ff3399">in</span>%&nbsp;<span style="color:#ffd500">'wheel_system'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Perform&nbsp;one-hot&nbsp;encoding&nbsp;for&nbsp;the&nbsp;'body_type'&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cbind(df_dt_encoded,&nbsp;model.matrix(~&nbsp;body_type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_encoded))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Remove&nbsp;the&nbsp;original&nbsp;'body_type'&nbsp;column&nbsp;after&nbsp;encoding</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_encoded&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded[,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">!</span>names(df_dt_encoded)&nbsp;%<span style="color:#ff3399">in</span>%&nbsp;<span style="color:#ffd500">'body_type'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;For&nbsp;regression</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Dataset&nbsp;for&nbsp;a&nbsp;model&nbsp;that&nbsp;predicts&nbsp;vehicle&nbsp;prices&nbsp;through&nbsp;regression&nbsp;among&nbsp;decision&nbsp;trees</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Label&nbsp;is&nbsp;set&nbsp;to&nbsp;vehicle&nbsp;price</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Dataframe&nbsp;for&nbsp;regression</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_encoded</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Change&nbsp;the&nbsp;column&nbsp;name&nbsp;'price'&nbsp;to&nbsp;'label'&nbsp;in&nbsp;df_dt_regression</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">colnames(df_dt_regression)[colnames(df_dt_regression)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"price"</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#ffd500">"label"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Identify&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;'label'&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">label_column_index&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;which(names(df_dt_regression)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"label"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Move&nbsp;the&nbsp;'label'&nbsp;column&nbsp;to&nbsp;the&nbsp;last&nbsp;position</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_regression[,&nbsp;c(<span style="color:#c10aff">1</span>:(label_column_index&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#c10aff">1</span>),&nbsp;(label_column_index&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;<span style="color:#c10aff">1</span>):ncol(df_dt_regression),&nbsp;label_column_index)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Split&nbsp;the&nbsp;dataset</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">set.seed(<span style="color:#c10aff">123</span>)&nbsp;<span style="color:#999999">#reproducability&nbsp;setting</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_indices_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;sample(<span style="color:#c10aff">1</span>:nrow(df_dt_regression),&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">7</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;nrow(df_dt_regression))<span style="color:#999999">#createDataPartition(y&nbsp;=&nbsp;df_dt_regression$label,&nbsp;p&nbsp;=&nbsp;0.7,&nbsp;list&nbsp;=&nbsp;FALSE)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_train_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_regression[train_indices_regression,&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_test_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt_regression[<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>train_indices_regression,&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">cat(<span style="color:#ffd500">"Training&nbsp;set&nbsp;length:&nbsp;"</span>,&nbsp;nrow(df_dt_train_regression),&nbsp;<span style="color:#ffd500">"\n"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">cat(<span style="color:#ffd500">"Test&nbsp;set&nbsp;length:&nbsp;"</span>,&nbsp;nrow(df_dt_test_regression),&nbsp;<span style="color:#ffd500">"\n"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;For&nbsp;classification</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Label&nbsp;is&nbsp;set&nbsp;to&nbsp;vehicle&nbsp;price</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Add&nbsp;a&nbsp;new&nbsp;column&nbsp;(category)&nbsp;to&nbsp;the&nbsp;dataframe&nbsp;to&nbsp;convert&nbsp;price&nbsp;into&nbsp;a&nbsp;categorical&nbsp;variable</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt$label&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cut(df_dt$price,&nbsp;breaks&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(<span style="color:#c10aff">0</span>,&nbsp;<span style="color:#c10aff">13000</span>,&nbsp;<span style="color:#c10aff">30000</span>,&nbsp;<span style="color:#c10aff">10000000</span>),&nbsp;labels&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(<span style="color:#ffd500">"Low"</span>,&nbsp;<span style="color:#ffd500">"Moderate"</span>,&nbsp;<span style="color:#ffd500">"High"</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt$label&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;<span style="color:#ff3399">as</span>.factor(df_dt$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Delete&nbsp;price&nbsp;column</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt[,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>which(names(df_dt)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"price"</span>)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt$label</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Split&nbsp;the&nbsp;dataset</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">set.seed(<span style="color:#c10aff">123</span>)&nbsp;<span style="color:#999999">#reproducability&nbsp;setting</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_indices&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;sample(<span style="color:#c10aff">1</span>:nrow(df_dt),&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">7</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;nrow(df_dt))</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_train&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt[train_indices,&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_test&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;df_dt[<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>train_indices,&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">cat(<span style="color:#ffd500">"Training&nbsp;set&nbsp;length:&nbsp;"</span>,&nbsp;nrow(df_dt_train),&nbsp;<span style="color:#ffd500">"\n"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">cat(<span style="color:#ffd500">"Test&nbsp;set&nbsp;length:&nbsp;"</span>,&nbsp;nrow(df_dt_test),&nbsp;<span style="color:#ffd500">"\n"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_dt_html&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;kable(head(df_dt),&nbsp;<span style="color:#4be6fa">format</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"html"</span>,&nbsp;table.attr&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"style='width:100%;'"</span>)&nbsp;%<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>%</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;kable_styling(full_width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;result&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;character(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specificity&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;numeric(),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">write.csv(df_dt,&nbsp;<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_dt_sampled_preprocessed.csv"</span>)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">write.csv(df_dt_train,&nbsp;<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_dt_sampled_preprocessed_train.csv"</span>)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">write.csv(df_dt_test,&nbsp;<span style="color:#ffd500">"used_cars_data_cleaned_final_ver_dt_sampled_preprocessed_test.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Gini</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(df_dt_train$label&nbsp;~.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'class'</span>)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;a&nbsp;high-quality&nbsp;PNG&nbsp;file</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">png(<span style="color:#ffd500">"fancyRpartPlot_gini.png"</span>,&nbsp;width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3600</span>,&nbsp;height&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">2800</span>,&nbsp;units&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"px"</span>,&nbsp;pointsize&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">12</span>,&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">600</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">fancyRpartPlot(rpart_gini)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Save&nbsp;the&nbsp;plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">dev.off()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Extract&nbsp;variable&nbsp;importance</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">var_imp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;varImp(rpart_gini)&nbsp;%<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>%&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rownames_to_column()&nbsp;%<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>%&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrange(desc(Overall))&nbsp;%<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>%&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slice(<span style="color:#c10aff">1</span>:<span style="color:#c10aff">20</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">ggplot(var_imp,&nbsp;aes(x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;reorder(rowname,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>Overall),&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Overall))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_bar(stat&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"identity"</span>,&nbsp;fill&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"steelblue"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;labs(title&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Top&nbsp;20&nbsp;Variable&nbsp;Importance"</span>,&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Variable"</span>,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Importance"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;theme(axis.text.x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;element_text(angle&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">45</span>,&nbsp;hjust&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Find&nbsp;the&nbsp;cp&nbsp;value&nbsp;for&nbsp;pruning</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;printcp(rpart_gini)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;cp_value&nbsp;&lt;-&nbsp;rpart_gini$cptable[which.min(rpart_gini$cptable[,"xerror"]),"CP"]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;pruned_rpart_entropy&nbsp;&lt;-&nbsp;prune(rpart_entropy,&nbsp;cp&nbsp;=&nbsp;0.02)&nbsp;&nbsp;#&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;fancyRpartPlot(pruned_rpart_entropy)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Prediction</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_gini_pd&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_gini,&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Calculate&nbsp;confusion&nbsp;matrix</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">confusion_matrix_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusionMatrix(rpart_gini_pd,&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Calculate&nbsp;accuracy,&nbsp;precision,&nbsp;recall,&nbsp;specificity,&nbsp;and&nbsp;F1&nbsp;score&nbsp;for&nbsp;Gini&nbsp;method</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_gini$overall[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">precision_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_gini$byClass[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">recall_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_gini$byClass[<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">specificity_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_gini$byClass[<span style="color:#c10aff">3</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">f1_score_gini&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_gini$byClass[<span style="color:#c10aff">4</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">new_row&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Gini"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy_gini,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;precision_gini,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recall_gini,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specificity&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;specificity_gini,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;f1_score_gini,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rbind(result_df,&nbsp;new_row)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Entropy</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(df_dt_train$label&nbsp;~.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'class'</span>,&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">"information"</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart.plot(rpart_entropy)</div><div style="padding:0 6px; white-space:pre; line-height:130%">fancyRpartPlot(rpart_entropy)</div><div style="padding:0 6px; white-space:pre; line-height:130%">prp(rpart_entropy)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Prediction</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_entropy_pd&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_entropy,&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">"information"</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Calculate&nbsp;confusion&nbsp;matrix</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">confusion_matrix_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusionMatrix(rpart_entropy_pd,&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Calculate&nbsp;accuracy,&nbsp;precision,&nbsp;recall,&nbsp;specificity,&nbsp;and&nbsp;F1&nbsp;score&nbsp;for&nbsp;Entropy&nbsp;method</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_entropy$overall[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">precision_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_entropy$byClass[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">recall_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_entropy$byClass[<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">specificity_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_entropy$byClass[<span style="color:#c10aff">3</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">f1_score_entropy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_entropy$byClass[<span style="color:#c10aff">4</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">new_row&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Entropy"</span>,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy_entropy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;precision_entropy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recall_entropy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specificity&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;specificity_entropy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;f1_score_entropy,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rbind(result_df,&nbsp;new_row)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;minsplit&nbsp;=&nbsp;10,&nbsp;20,&nbsp;30Permalink</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(s&nbsp;<span style="color:#ff3399">in</span>&nbsp;c(<span style="color:#ffd500">'gini'</span>,&nbsp;<span style="color:#ffd500">'information'</span>)){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;c(<span style="color:#c10aff">1</span>,&nbsp;<span style="color:#c10aff">5</span>,&nbsp;<span style="color:#c10aff">10</span>,&nbsp;<span style="color:#c10aff">20</span>,&nbsp;<span style="color:#c10aff">40</span>)){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;rpart_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(df_dt_train$label&nbsp;~.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'class'</span>,control&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;rpart.control(minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;i),&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>s)&nbsp;)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#fancyRpartPlot(rpart_minsplit)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;rpart_minsplit_pd&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_minsplit,&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>s))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Calculate&nbsp;confusion&nbsp;matrix</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;confusion_matrix_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusionMatrix(rpart_minsplit_pd,&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Calculate&nbsp;accuracy,&nbsp;precision,&nbsp;recall,&nbsp;specificity,&nbsp;and&nbsp;F1&nbsp;score&nbsp;for&nbsp;Gini&nbsp;method</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;accuracy_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_minsplit$overall[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;precision_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_minsplit$byClass[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;recall_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_minsplit$byClass[<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;specificity_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_minsplit$byClass[<span style="color:#c10aff">3</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;f1_score_minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_minsplit$byClass[<span style="color:#c10aff">4</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;new_row&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;ifelse(s&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'gini'</span>,&nbsp;<span style="color:#ffd500">'Gini'</span>,&nbsp;ifelse(s&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'information'</span>,&nbsp;<span style="color:#ffd500">'Entropy'</span>,&nbsp;NA)),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy_minsplit,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;precision_minsplit,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recall_minsplit,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specificity&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;specificity_minsplit,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;f1_score_minsplit,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rbind(result_df,&nbsp;new_row)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;minsplit&nbsp;=&nbsp;4,&nbsp;5,&nbsp;6&nbsp;maxdepth</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">###########################################################################################</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(s&nbsp;<span style="color:#ff3399">in</span>&nbsp;c(<span style="color:#ffd500">'gini'</span>,&nbsp;<span style="color:#ffd500">'information'</span>)){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;c(<span style="color:#c10aff">2</span>,&nbsp;<span style="color:#c10aff">3</span>,&nbsp;<span style="color:#c10aff">4</span>,&nbsp;<span style="color:#c10aff">5</span>,&nbsp;<span style="color:#c10aff">6</span>,&nbsp;<span style="color:#c10aff">7</span>)){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;rpart_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(df_dt_train$label&nbsp;~.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'class'</span>,control&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;rpart.control(maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;i),&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>s))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;fancyRpartPlot(rpart_maxdepth)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;png(paste0(<span style="color:#ffd500">"fancyRpartPlot_"</span>,s,<span style="color:#ffd500">"_maxdepth_"</span>,i,<span style="color:#ffd500">".png"</span>),&nbsp;width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3600</span>,&nbsp;height&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">2800</span>,&nbsp;units&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"px"</span>,&nbsp;pointsize&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">12</span>,&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">600</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;fancyRpartPlot(rpart_maxdepth)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Save&nbsp;the&nbsp;plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;dev.off()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;rpart_maxdepth_pd&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_maxdepth,&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;parms&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;list(split<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>s))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;confusion_matrix_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusionMatrix(rpart_maxdepth_pd,&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;Calculate&nbsp;accuracy,&nbsp;precision,&nbsp;recall,&nbsp;specificity,&nbsp;and&nbsp;F1&nbsp;score&nbsp;for&nbsp;Gini&nbsp;method</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;accuracy_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_maxdepth$overall[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;precision_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_maxdepth$byClass[<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;recall_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_maxdepth$byClass[<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;specificity_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_maxdepth$byClass[<span style="color:#c10aff">3</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;f1_score_maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;confusion_matrix_maxdepth$byClass[<span style="color:#c10aff">4</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;new_row&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(Method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;ifelse(s&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'gini'</span>,&nbsp;<span style="color:#ffd500">'Gini'</span>,&nbsp;ifelse(s&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'information'</span>,&nbsp;<span style="color:#ffd500">'Entropy'</span>,&nbsp;NA)),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minsplit&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maxdepth&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy_maxdepth,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Precision&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;precision_maxdepth,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recall&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recall_maxdepth,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specificity&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;specificity_maxdepth,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1_Score&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;f1_score_maxdepth,</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stringsAsFactors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;FALSE)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;result_df&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rbind(result_df,&nbsp;new_row)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">result_df</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;the&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_regression&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train_regression)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;a&nbsp;high-quality&nbsp;PNG&nbsp;file</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">png(<span style="color:#ffd500">"fancyRpartPlot_regression.png"</span>,&nbsp;width&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3600</span>,&nbsp;height&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">2800</span>,&nbsp;units&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"px"</span>,&nbsp;pointsize&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">12</span>,&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">600</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">fancyRpartPlot(rpart_regression)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Save&nbsp;the&nbsp;plot</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">dev.off()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Visualize&nbsp;the&nbsp;decision&nbsp;tree</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart.plot(rpart_regression,&nbsp;main&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Decision&nbsp;Tree&nbsp;for&nbsp;Regression"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Predict&nbsp;using&nbsp;the&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_regression,&nbsp;df_dt_test_regression)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">mse&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mse(df_dt_test_regression$label,&nbsp;predictions)</div><div style="padding:0 6px; white-space:pre; line-height:130%">mae&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mae(df_dt_test_regression$label,&nbsp;predictions)</div><div style="padding:0 6px; white-space:pre; line-height:130%">rsquared&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;R2(predictions,&nbsp;df_dt_test_regression$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;a&nbsp;table&nbsp;to&nbsp;display&nbsp;the&nbsp;evaluation&nbsp;metrics</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">evaluation_table&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;Metric&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(<span style="color:#ffd500">"Mean&nbsp;Squared&nbsp;Error"</span>,&nbsp;<span style="color:#ffd500">"Mean&nbsp;Absolute&nbsp;Error"</span>,&nbsp;<span style="color:#ffd500">"R-Squared"</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;Value&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(mse,&nbsp;mae,&nbsp;rsquared)</div><div style="padding:0 6px; white-space:pre; line-height:130%">)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">evaluation_table&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(<span style="color:#ffd500">"MSE"</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;mse,&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ffd500">"MAE"</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;mae,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ffd500">"R-Squared"</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;rsquared)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Print&nbsp;the&nbsp;evaluation&nbsp;table</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(evaluation_table)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;a&nbsp;decision&nbsp;tree&nbsp;model&nbsp;on&nbsp;training&nbsp;and&nbsp;test&nbsp;sets</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_model_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'class'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_model_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'class'</span>,&nbsp;cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">001</span>)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Tree&nbsp;visualization&nbsp;before&nbsp;pruning&nbsp;for&nbsp;training&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart.plot(rpart_model_before,&nbsp;main&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Decision&nbsp;Tree&nbsp;Before&nbsp;Pruning"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Tree&nbsp;visualization&nbsp;after&nbsp;pruning&nbsp;on&nbsp;the&nbsp;training&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart.plot(rpart_model_after,&nbsp;main&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Decision&nbsp;Tree&nbsp;After&nbsp;Pruning"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">train_predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_before,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train_predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_after,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Accuracy&nbsp;output&nbsp;of&nbsp;training&nbsp;set&nbsp;and&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Predictions&nbsp;on&nbsp;the&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_before,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_after,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Accuracy&nbsp;comparison&nbsp;before&nbsp;and&nbsp;after&nbsp;pruning</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Result&nbsp;output</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"Accuracy&nbsp;before&nbsp;pruning:"</span>,&nbsp;accuracy_before))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"Accuracy&nbsp;after&nbsp;pruning:"</span>,&nbsp;accuracy_after))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Check&nbsp;for&nbsp;overfitting</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">if</span>&nbsp;(train_accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">05</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Overfitting&nbsp;detected&nbsp;before&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}&nbsp;<span style="color:#ff3399">else</span>&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"No&nbsp;overfitting&nbsp;detected&nbsp;before&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">if</span>&nbsp;(train_accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">05</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Overfitting&nbsp;detected&nbsp;after&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}&nbsp;<span style="color:#ff3399">else</span>&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"No&nbsp;overfitting&nbsp;detected&nbsp;after&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Predictions&nbsp;on&nbsp;the&nbsp;training&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_before,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train_predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model_after,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Accuracy&nbsp;output&nbsp;of&nbsp;training&nbsp;set&nbsp;and&nbsp;test&nbsp;set</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"Train&nbsp;Accuracy&nbsp;before&nbsp;pruning:"</span>,&nbsp;train_accuracy_before))</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"Train&nbsp;Accuracy&nbsp;after&nbsp;pruning:"</span>,&nbsp;train_accuracy_after))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Check&nbsp;for&nbsp;overfitting</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">if</span>&nbsp;(train_accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;accuracy_before&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">05</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Overfitting&nbsp;detected&nbsp;before&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}&nbsp;<span style="color:#ff3399">else</span>&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"No&nbsp;overfitting&nbsp;detected&nbsp;before&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">if</span>&nbsp;(train_accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;accuracy_after&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">05</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"Overfitting&nbsp;detected&nbsp;after&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}&nbsp;<span style="color:#ff3399">else</span>&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(<span style="color:#ffd500">"No&nbsp;overfitting&nbsp;detected&nbsp;after&nbsp;pruning."</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;model</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">rpart_model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'class'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Error&nbsp;visualization&nbsp;based&nbsp;on&nbsp;cp&nbsp;value</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">plotcp(rpart_model)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Find&nbsp;the&nbsp;optimal&nbsp;cp&nbsp;value</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">opt_cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart_model$cptable[which.min(rpart_model$cptable[,<span style="color:#ffd500">"xerror"</span>]),<span style="color:#ffd500">"CP"</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"Optimal&nbsp;CP&nbsp;value:"</span>,&nbsp;opt_cp))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;a&nbsp;sequence&nbsp;of&nbsp;cp&nbsp;values</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">cp_seq&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;seq(<span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span>,&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>,&nbsp;by&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;empty&nbsp;vectors&nbsp;to&nbsp;store&nbsp;accuracy&nbsp;values</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">test_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;models&nbsp;with&nbsp;different&nbsp;cp&nbsp;values&nbsp;and&nbsp;compute&nbsp;accuracies</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">1</span>:length(cp_seq))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;rpart_model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp_seq[i])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Plot&nbsp;the&nbsp;learning&nbsp;curve</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">learning_curve&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp_seq,&nbsp;train_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_accuracy)</div><div style="padding:0 6px; white-space:pre; line-height:130%">ggplot(learning_curve,&nbsp;aes(x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_accuracy))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_line()&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;labs(title&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Learning&nbsp;Curve"</span>,&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"CP&nbsp;Value"</span>,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Accuracy"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;theme_minimal()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Find&nbsp;the&nbsp;cp&nbsp;value&nbsp;where&nbsp;overfitting&nbsp;occurs</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">overfitting_cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cp_seq[which.max(train_accuracy)]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#4be6fa">print</span>(paste(<span style="color:#ffd500">"CP&nbsp;value&nbsp;where&nbsp;overfitting&nbsp;occurs:"</span>,&nbsp;overfitting_cp))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Define&nbsp;a&nbsp;sequence&nbsp;of&nbsp;cp&nbsp;values</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">cp_seq&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;seq(<span style="color:#c10aff">0.</span><span style="color:#c10aff">0001</span>,&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>,&nbsp;by&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">0005</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;empty&nbsp;vectors&nbsp;to&nbsp;store&nbsp;accuracy&nbsp;values</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">test_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;models&nbsp;with&nbsp;different&nbsp;cp&nbsp;values&nbsp;and&nbsp;compute&nbsp;accuracies</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">1</span>:length(cp_seq))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;rpart_model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp_seq[i])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;test_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;test_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(test_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Create&nbsp;empty&nbsp;vectors&nbsp;to&nbsp;store&nbsp;accuracy&nbsp;values</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">test_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy_diff&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;vector(<span style="color:#ffd500">"numeric"</span>,&nbsp;length&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;length(cp_seq))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Train&nbsp;models&nbsp;with&nbsp;different&nbsp;cp&nbsp;values&nbsp;and&nbsp;compute&nbsp;accuracies</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">1</span>:length(cp_seq))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;rpart_model&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;rpart(label&nbsp;~&nbsp;.,&nbsp;data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;method&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>,&nbsp;cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp_seq[i])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;train_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(train_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_train$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;test_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;predict(rpart_model,&nbsp;newdata&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test,&nbsp;type&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"class"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;test_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;mean(test_predictions&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;df_dt_test$label)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;accuracy_diff[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;abs(train_accuracy[i]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;test_accuracy[i])</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Filter&nbsp;values&nbsp;with&nbsp;accuracy&nbsp;difference&nbsp;&lt;=&nbsp;0.05</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">filtered_indices&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;which(accuracy_diff&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">05</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">optimal_cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;cp_seq[filtered_indices[<span style="color:#c10aff">1</span>]]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Plot&nbsp;the&nbsp;learning&nbsp;curve</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">learning_curve&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;data.frame(cp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp_seq,&nbsp;train_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_accuracy,&nbsp;test_accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;test_accuracy,&nbsp;accuracy_diff&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;accuracy_diff)</div><div style="padding:0 6px; white-space:pre; line-height:130%">ggplot(learning_curve,&nbsp;aes(x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;cp))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_line(aes(y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;train_accuracy,&nbsp;color&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Train&nbsp;Accuracy"</span>))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_line(aes(y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;test_accuracy,&nbsp;color&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Test&nbsp;Accuracy"</span>))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;labs(title&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;paste(<span style="color:#ffd500">"Learning&nbsp;Curve&nbsp;(Optimal&nbsp;CP&nbsp;="</span>,&nbsp;round(optimal_cp,&nbsp;<span style="color:#c10aff">3</span>),&nbsp;<span style="color:#ffd500">")"</span>),&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"CP&nbsp;Value"</span>,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Accuracy"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;scale_color_manual(name&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"Accuracy"</span>,&nbsp;values&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;c(<span style="color:#ffd500">"Train&nbsp;Accuracy"</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"blue"</span>,&nbsp;<span style="color:#ffd500">"Test&nbsp;Accuracy"</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"red"</span>))&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;theme_minimal()&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;geom_vline(xintercept&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;optimal_cp,&nbsp;linetype&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"dashed"</span>,&nbsp;color&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"green"</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;annotate(<span style="color:#ffd500">"text"</span>,&nbsp;x&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;optimal_cp,&nbsp;y&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;max(learning_curve$test_accuracy),&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;paste(<span style="color:#ffd500">"Optimal&nbsp;CP&nbsp;="</span>,&nbsp;round(optimal_cp,&nbsp;<span style="color:#c10aff">3</span>)),&nbsp;vjust&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;hjust&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>,&nbsp;color&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"green"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
</div>